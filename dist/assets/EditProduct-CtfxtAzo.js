import{a,l as o,F as P,j as G,n as J,k as K,B as E}from"./index-C8hkmiMv.js";import{P as q,h as H}from"./PreviewImage-BR2p0XmV.js";import{g,a as I,b as Q,c as j,d as y,U as x}from"./FormItems-DzKu2vhD.js";import{C as W}from"./Collapse-BiZ5-3F6.js";import"./index-DZfnbcqf.js";import"./Skeleton-BR8CdXyJ.js";import"./useForceUpdate-Dr_bxTJE.js";const X=({form:d,data:r,categoryData:n,tagsData:l,sizesData:p,finishesData:f})=>(a.useEffect(()=>{d.setFieldsValue({prdName:r==null?void 0:r.name,prdCode:r==null?void 0:r.code,prdDesc:r==null?void 0:r.description,prdFinish:r==null?void 0:r.finish,prdThickness:r==null?void 0:r.thickness,prdSize:r==null?void 0:r.size,prdColor:r==null?void 0:r.color,prdVariation:r==null?void 0:r.variation,prdTag:r==null?void 0:r.tags,prdCategory:r==null?void 0:r.categories})},[r]),o.jsxDEV(o.Fragment,{children:o.jsxDEV("div",{className:"form-container",children:[o.jsxDEV("div",{className:"form-wrap",children:o.jsxDEV(P,{layout:"vertical",form:d,className:"form-box",children:[g("Product Name","prdName","Please fill in the Product Name.","",!0),n&&n.length>0&&I("Product Category","prdCategory","Please select category.",!1,n),g("Product Variation","prdVariation","Please fill in the Product Variation."),Q("Product Description","prdDesc","Please fill in the Product Description.",9)]},void 0,!0,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:35,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:34,columnNumber:17},void 0),o.jsxDEV("div",{className:"form-wrap",children:o.jsxDEV(P,{layout:"vertical",form:d,className:"form-box",children:[g("Product Code","prdCode","Please fill in the Product Code.","",!0),g("Product Thickness","prdThickness","Please fill in the Product Thickness."),p&&p.length>0&&j("Product Size","prdSize","Please select a Product Size.",!1,p),f&&f.length>0&&j("Product Finishes","prdFinish","Please select a Product Finishes.",!1,f),g("Product Color","prdColor","Please fill in the Product Color.","",!0),l&&l.length>0&&I("Product Tags","prdTag","Please select Tag.",!1,l)]},void 0,!0,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:51,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:50,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:33,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:32,columnNumber:9},void 0)),ce=()=>{const d=G(),r="Edit Product",{id:n}=J(),[l]=P.useForm(),[p,f]=a.useState(),[C,z]=a.useState(),[k,D]=a.useState(),[U,V]=a.useState(),[F,S]=a.useState(),{setSuccessNotification:h,setErrorNotification:m}=K(),[Y,T]=a.useState(),[Z,w]=a.useState(),[$,N]=a.useState({previewVisible:!1,previewImage:"",previewTitle:""}),b=e=>e.type==="image/jpeg"||e.type==="image/png"?e.size>1e6?(m("Image file size is more than 1MB. Please try a smaller size file."),x.LIST_IGNORE):!1:(m("Only .jpg, .jpeg and .png image file format are accepted!"),x.LIST_IGNORE),M=e=>Array.isArray(e)?e:(T(e.file),e&&e.fileList),O=e=>Array.isArray(e)?e:(w(e.file),e&&e.fileList),v=async e=>{e=await H(e),N({previewVisible:!0,previewImage:e.url||e.preview,previewTitle:e.name||e.url.substring(e.url.lastIndexOf("/")+1)})},A=[{key:"1",label:"Basic Information",children:o.jsxDEV(X,{form:l,data:p,categoryData:C,tagsData:k,sizesData:U,finishesData:F},void 0,!1,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:78,columnNumber:9},void 0)},{key:"2",label:"Product Images",children:o.jsxDEV("div",{className:"form-container",children:o.jsxDEV("div",{className:"form-wrap",children:o.jsxDEV(P,{layout:"vertical",form:l,className:"form-box",children:y("images","Product Image",M,v,b,!0)},void 0,!1,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:94,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:93,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:92,columnNumber:9},void 0)},{key:"3",label:"Mock Images",children:o.jsxDEV("div",{className:"form-container",children:o.jsxDEV("div",{className:"form-wrap",children:o.jsxDEV(P,{layout:"vertical",form:l,className:"form-box",children:y("mockedImages","Mocked Image",O,v,b,!0)},void 0,!1,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:114,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:113,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:112,columnNumber:9},void 0)}],_=e=>{console.log(e)};a.useEffect(()=>{fetch(`https://bo-api.lorenzaceramica.com/product-details/${n}`).then(e=>e.json()).then(e=>{let t=[],s=[];e.images.length!==0&&e.images.map((i,u)=>t.push({uid:`-${u+1}`,name:`image_${u+1}_${Date.now()}`,status:"done",url:i})),e.mockedImages.length!==0&&e.mockedImages.map((i,u)=>s.push({uid:`-${u+1}`,name:`image_${u+1}_${Date.now()}`,status:"done",url:i})),l.setFieldsValue({images:t,mockedImages:s}),f(e)})},[]),a.useEffect(()=>{fetch("https://bo-api.lorenzaceramica.com/all-categories-no-level").then(e=>e.json()).then(e=>{let t=[];e.map(s=>{t.push({val:s.id,label:s.name})}),z(t)})},[]),a.useEffect(()=>{fetch("https://bo-api.lorenzaceramica.com/all-tags-no-level").then(e=>e.json()).then(e=>{let t=[];e.map(s=>{t.push({val:s.id,label:s.name})}),D(t)})},[]),a.useEffect(()=>{fetch("https://bo-api.lorenzaceramica.com/all-sizes").then(e=>e.json()).then(e=>{let t=[];e.map(s=>{t.push({val:s.id,label:s.name,id:s.id})}),V(t)})},[]),a.useEffect(()=>{fetch("https://bo-api.lorenzaceramica.com/all-finishes").then(e=>e.json()).then(e=>{let t=[];e.map(s=>{t.push({val:s.id,label:s.name,id:s.id})}),S(t)})},[]);const B=async e=>{for(const t of e){const s=new FormData;s.append("image",t.originFileObj),fetch(`https://bo-api.lorenzaceramica.com/upload-products-images/${n}`,{method:"POST",body:s}).then(async i=>{i.status===201&&(h("Upload Product Images Successful!"),d("/product-listing"))}).catch(i=>{console.log("Upload Product Images error:",i),m("Upload Product Images Failed. Please try again later.")})}},L=async e=>{for(const t of e){const s=new FormData;s.append("image",t.originFileObj),fetch(`https://bo-api.lorenzaceramica.com/upload-mocked-images/${n}`,{method:"POST",body:s}).then(async i=>{i.status===201&&(h("Upload Mocked Images Successful!"),d("/product-listing"))}).catch(i=>{console.log("Upload Mocked Images error:",i),m("Upload Mocked Images Failed. Please try again later.")})}},R=()=>{const e=l.getFieldsValue();if(e.images===void 0||e.images&&e.images.length===0)return m("Please ensure that image is uploaded.");if(e.mockedImages===void 0||e.mockedImages&&e.mockedImages.length===0)return m("Please ensure that Mocked Image is uploaded.");if(e.mockedImages.length>3)return m("Mocked Images only allow to upload 3(three) images.");let t=[],s=[],i=[];for(const c of e.images)c.status==="done"?t.push(c.url):s.push(c);for(const c of e.mockedImages)c.status==="done"?t.push(c.url):i.push(c);const u={name:e.prdName,code:e.prdCode,description:e.prdDesc,variation:e.prdVariation,thickness:e.prdThickness,color:e.prdColor,tags:e.prdTag,categories:e.prdCategory,size:e.prdSize,finish:e.prdFinish,notDeletedImageUrls:t};fetch("https://bo-api.lorenzaceramica.com/update-product",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...u,id:n})}).then(async c=>{c.status===204&&(h("Update Successful!"),s.length!==0&&B(s),i.length!==0&&L(i),s.length===0&&i.length===0&&d("/product-listing"))}).catch(c=>{console.log("Update Product error:",c),m("Update Failed. Please try again later.")})};return o.jsxDEV(o.Fragment,{children:[o.jsxDEV("div",{style:{textAlign:"left"},children:[o.jsxDEV("h2",{children:r},void 0,!1,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:359,columnNumber:9},void 0),o.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:360,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:358,columnNumber:7},void 0),o.jsxDEV(W,{style:{textAlign:"left"},items:A,defaultActiveKey:["1","2","3"],onChange:_},void 0,!1,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:362,columnNumber:7},void 0),";",o.jsxDEV("div",{className:"form-action-button-container",children:[o.jsxDEV(E,{type:"primary",className:"form-button",onClick:R,children:"Save"},void 0,!1,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:371,columnNumber:9},void 0),o.jsxDEV(E,{className:"form-button",onClick:()=>d("/product-listing"),children:"Cancel"},void 0,!1,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:374,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:370,columnNumber:7},void 0),o.jsxDEV(q,{displayImg:$,setDisplayImg:N},void 0,!1,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:381,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/70080397/Projects/free/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:357,columnNumber:5},void 0)};export{ce as default};
