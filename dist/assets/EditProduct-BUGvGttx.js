import{a as c,l as t,F as P,j as _,n as B,k as G,B as v}from"./index-PcU8TtCF.js";import{P as J,h as K}from"./PreviewImage-z1sSscEd.js";import{g,a as I,b as H,c as j,d as Q,e as D,U}from"./FormItems-CDXenqOX.js";import{C as W}from"./Collapse-BxhlyesM.js";import"./index-BHKqFL6p.js";import"./Skeleton-DdI-TMQY.js";import"./useForceUpdate-CPSZ4iGj.js";const X=({form:u,data:s,categoryData:d,tagsData:a,sizesData:p,finishesData:f})=>(c.useEffect(()=>{u.setFieldsValue({prdName:s==null?void 0:s.name,prdCode:s==null?void 0:s.code,prdDesc:s==null?void 0:s.description,prdFinish:s==null?void 0:s.finish,prdThickness:s==null?void 0:s.thickness,prdSize:s==null?void 0:s.size,prdColor:s==null?void 0:s.color,prdVariation:s==null?void 0:s.variation,prdTag:s==null?void 0:s.tags,prdCategory:s==null?void 0:s.categories,sequence:s==null?void 0:s.sequence})},[s]),t.jsxDEV(t.Fragment,{children:t.jsxDEV("div",{className:"form-container",children:[t.jsxDEV("div",{className:"form-wrap",children:t.jsxDEV(P,{layout:"vertical",form:u,className:"form-box",children:[g("Product Name","prdName","Please fill in the Product Name.","",!0),d&&d.length>0&&I("Product Category","prdCategory","Please select category.",!1,d),g("Product Variation","prdVariation","Please fill in the Product Variation."),H("Product Description","prdDesc","Please fill in the Product Description.",9)]},void 0,!0,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:36,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:35,columnNumber:17},void 0),t.jsxDEV("div",{className:"form-wrap",children:t.jsxDEV(P,{layout:"vertical",form:u,className:"form-box",children:[g("Product Code","prdCode","Please fill in the Product Code.","",!0),g("Product Thickness","prdThickness","Please fill in the Product Thickness."),p&&p.length>0&&j("Product Size","prdSize","Please select a Product Size.",!1,p),f&&f.length>0&&j("Product Finishes","prdFinish","Please select a Product Finishes.",!1,f),g("Product Color","prdColor","Please fill in the Product Color.","",!0),a&&a.length>0&&I("Product Tags","prdTag","Please select Tag.",!1,a),Q("Sequence","sequence","Please fill in sequence.")]},void 0,!0,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:52,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:51,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:34,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:33,columnNumber:9},void 0)),ae=()=>{const u=_(),s="Edit Product",{id:d}=B(),[a]=P.useForm(),[p,f]=c.useState(),[x,y]=c.useState(),[C,z]=c.useState(),[V,F]=c.useState(),[O,k]=c.useState(),{setSuccessNotification:N,setErrorNotification:m}=G(),[Y,A]=c.useState(),[ee,S]=c.useState(),[L,h]=c.useState({previewVisible:!1,previewImage:"",previewTitle:""}),E=e=>e.type==="image/jpeg"||e.type==="image/png"?e.size>1e6?(m("Image file size is more than 1MB. Please try a smaller size file."),U.LIST_IGNORE):!1:(m("Only .jpg, .jpeg and .png image file format are accepted!"),U.LIST_IGNORE),R=e=>Array.isArray(e)?e:(A(e.file),e&&e.fileList),T=e=>Array.isArray(e)?e:(S(e.file),e&&e.fileList),b=async e=>{e=await K(e),h({previewVisible:!0,previewImage:e.url||e.preview,previewTitle:e.name||e.url.substring(e.url.lastIndexOf("/")+1)})},w=[{key:"1",label:"Basic Information",children:t.jsxDEV(X,{form:a,data:p,categoryData:x,tagsData:C,sizesData:V,finishesData:O},void 0,!1,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:78,columnNumber:9},void 0)},{key:"2",label:"Product Images",children:t.jsxDEV("div",{className:"form-container",children:t.jsxDEV("div",{className:"form-wrap",children:t.jsxDEV(P,{layout:"vertical",form:a,className:"form-box",children:D("images","Product Image",R,b,E,!0)},void 0,!1,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:94,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:93,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:92,columnNumber:9},void 0)},{key:"3",label:"Mock Images",children:t.jsxDEV("div",{className:"form-container",children:t.jsxDEV("div",{className:"form-wrap",children:t.jsxDEV(P,{layout:"vertical",form:a,className:"form-box",children:D("mockedImages","Mocked Image",T,b,E,!0)},void 0,!1,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:114,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:113,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:112,columnNumber:9},void 0)}],Z=e=>{console.log(e)};c.useEffect(()=>{fetch(`https://bo-api.lorenzaceramica.com/product-details/${d}`).then(e=>e.json()).then(e=>{let o=[],r=[];e.images.length!==0&&e.images.map((i,l)=>o.push({uid:`-${l+1}`,name:`image_${l+1}_${Date.now()}`,status:"done",url:i})),e.mockedImages.length!==0&&e.mockedImages.map((i,l)=>r.push({uid:`-${l+1}`,name:`image_${l+1}_${Date.now()}`,status:"done",url:i})),a.setFieldsValue({images:o,mockedImages:r}),f(e)})},[]),c.useEffect(()=>{fetch("https://bo-api.lorenzaceramica.com/all-categories-no-level").then(e=>e.json()).then(e=>{let o=[];e.map(r=>{o.push({val:r.id,label:r.name})}),y(o)})},[]),c.useEffect(()=>{fetch("https://bo-api.lorenzaceramica.com/all-tags-no-level").then(e=>e.json()).then(e=>{let o=[];e.map(r=>{o.push({val:r.id,label:r.name})}),z(o)})},[]),c.useEffect(()=>{fetch("https://bo-api.lorenzaceramica.com/all-sizes").then(e=>e.json()).then(e=>{let o=[];e.map(r=>{o.push({val:r.id,label:r.name,id:r.id})}),F(o)})},[]),c.useEffect(()=>{fetch("https://bo-api.lorenzaceramica.com/all-finishes").then(e=>e.json()).then(e=>{let o=[];e.map(r=>{o.push({val:r.id,label:r.name,id:r.id})}),k(o)})},[]);const $=async(e,o)=>{const r=new FormData;for(let i=0;i<e.length;i++){const l=e[i];r.append(`image-${i}`,l.originFileObj)}fetch(`https://bo-api.lorenzaceramica.com/upload-products-images/${d}`,{method:"POST",body:r}).then(async i=>{i.status===201&&(o.length!==0&&await M(o),N("Upload Product Images Successful!"))}).catch(i=>{console.log("Upload Product Images error:",i),m("Upload Product Images Failed. Please try again later.")})},M=async e=>{const o=new FormData;for(let r=0;r<e.length;r++){const i=e[r];o.append(`image-${r}`,i.originFileObj)}fetch(`https://bo-api.lorenzaceramica.com/upload-mocked-images/${d}`,{method:"POST",body:o}).then(async r=>{r.status===201&&N("Upload Mocked Images Successful!")}).catch(r=>{console.log("Upload Mocked Images error:",r),m("Upload Mocked Images Failed. Please try again later.")})},q=()=>{const e=a.getFieldsValue();if(e.images===void 0||e.images&&e.images.length===0)return m("Please ensure that image is uploaded.");if(e.mockedImages.length>3)return m("Mocked Images only allow to upload 3(three) images.");let o=[],r=[],i=[];for(const n of e.images)n.status==="done"?o.push(n.url):r.push(n);for(const n of e.mockedImages)n.status==="done"?o.push(n.url):i.push(n);const l={name:e.prdName,code:e.prdCode,description:e.prdDesc,variation:e.prdVariation,thickness:e.prdThickness,color:e.prdColor,tags:e.prdTag,categories:e.prdCategory,size:e.prdSize,finish:e.prdFinish,sequence:e.sequence,notDeletedImageUrls:o};fetch("https://bo-api.lorenzaceramica.com/update-product",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...l,id:d})}).then(async n=>{n.status===204&&(N("Update Successful!"),r.length!==0&&await $(r,i),u("/product-listing"))}).catch(n=>{console.log("Update Product error:",n),m("Update Failed. Please try again later.")})};return t.jsxDEV(t.Fragment,{children:[t.jsxDEV("div",{style:{textAlign:"left"},children:[t.jsxDEV("h2",{children:s},void 0,!1,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:350,columnNumber:9},void 0),t.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:351,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:349,columnNumber:7},void 0),t.jsxDEV(W,{style:{textAlign:"left"},items:w,defaultActiveKey:["1","2","3"],onChange:Z},void 0,!1,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:353,columnNumber:7},void 0),";",t.jsxDEV("div",{className:"form-action-button-container",children:[t.jsxDEV(v,{type:"primary",className:"form-button",onClick:q,children:"Save"},void 0,!1,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:362,columnNumber:9},void 0),t.jsxDEV(v,{className:"form-button",onClick:()=>u("/product-listing"),children:"Cancel"},void 0,!1,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:365,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:361,columnNumber:7},void 0),t.jsxDEV(J,{displayImg:L,setDisplayImg:h},void 0,!1,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:372,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/User/Documents/Projects/LORENZA/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:348,columnNumber:5},void 0)};export{ae as default};
