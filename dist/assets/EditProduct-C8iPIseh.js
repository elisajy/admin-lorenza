import{a as n,l as s,F as f,j as R,n as G,k as J,B as v}from"./index-C2K8AR7W.js";import{P as K,h as H}from"./PreviewImage-IiUvUdrc.js";import{g as h,a as E,b as Q,c as z,d as W,e as I,U as k}from"./FormItems-BIhz8kcz.js";import{C as X}from"./Collapse-DJC44Ff8.js";import"./index-Cvpz9R5X.js";import"./Skeleton-BM-4ttUs.js";import"./useForceUpdate-C_cK0Z1j.js";const Y=({form:l,data:o,categoryData:m,tagsData:c,sizesData:g,finishesData:p})=>(n.useEffect(()=>{l.setFieldsValue({prdName:o==null?void 0:o.name,prdCode:o==null?void 0:o.code,prdDesc:o==null?void 0:o.description,prdFinish:o==null?void 0:o.finish,prdThickness:o==null?void 0:o.thickness,prdSize:o==null?void 0:o.size,prdColor:o==null?void 0:o.color,prdVariation:o==null?void 0:o.variation,prdTag:o==null?void 0:o.tags,prdCategory:o==null?void 0:o.categories,sequence:o==null?void 0:o.sequence})},[o]),s.jsxDEV(s.Fragment,{children:s.jsxDEV("div",{className:"form-container",children:[s.jsxDEV("div",{className:"form-wrap",children:s.jsxDEV(f,{layout:"vertical",form:l,className:"form-box",children:[h("Product Name","prdName","Please fill in the Product Name.","",!0),m&&m.length>0&&E("Product Category","prdCategory","Please select category.",!1,m),h("Product Variation","prdVariation","Please fill in the Product Variation."),Q("Product Description","prdDesc","Please fill in the Product Description.",9)]},void 0,!0,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:36,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:35,columnNumber:17},void 0),s.jsxDEV("div",{className:"form-wrap",children:s.jsxDEV(f,{layout:"vertical",form:l,className:"form-box",children:[h("Product Code","prdCode","Please fill in the Product Code.","",!0),h("Product Thickness","prdThickness","Please fill in the Product Thickness."),g&&g.length>0&&z("Product Size","prdSize","Please select a Product Size.",!1,g),p&&p.length>0&&z("Product Finishes","prdFinish","Please select a Product Finishes.",!1,p),h("Product Color","prdColor","Please fill in the Product Color.","",!0),c&&c.length>0&&E("Product Tags","prdTag","Please select Tag.",!1,c),W("Sequence","sequence","Please fill in sequence.")]},void 0,!0,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:52,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:51,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:34,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:33,columnNumber:9},void 0)),ce=()=>{const l=R(),o="Edit Product",{id:m}=G(),[c]=f.useForm(),[g,p]=n.useState(),[D,S]=n.useState(),[y,x]=n.useState(),[j,U]=n.useState(),[V,F]=n.useState(),{setSuccessNotification:P,setErrorNotification:d}=J(),[Z,L]=n.useState(),[ee,T]=n.useState(),[w,N]=n.useState({previewVisible:!1,previewImage:"",previewTitle:""}),C=e=>e.type==="image/jpeg"||e.type==="image/png"?e.size>1e6?(d("Image file size is more than 1MB. Please try a smaller size file."),k.LIST_IGNORE):!1:(d("Only .jpg, .jpeg and .png image file format are accepted!"),k.LIST_IGNORE),$=e=>Array.isArray(e)?e:(L(e.file),e&&e.fileList),M=e=>Array.isArray(e)?e:(T(e.file),e&&e.fileList),b=async e=>{e=await H(e),N({previewVisible:!0,previewImage:e.url||e.preview,previewTitle:e.name||e.url.substring(e.url.lastIndexOf("/")+1)})},O=[{key:"1",label:"Basic Information",children:s.jsxDEV(Y,{form:c,data:g,categoryData:D,tagsData:y,sizesData:j,finishesData:V},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:78,columnNumber:9},void 0)},{key:"2",label:"Product Images",children:s.jsxDEV("div",{className:"form-container",children:s.jsxDEV("div",{className:"form-wrap",children:s.jsxDEV(f,{layout:"vertical",form:c,className:"form-box",children:I("images","Product Image",$,b,C,!0)},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:94,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:93,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:92,columnNumber:9},void 0)},{key:"3",label:"Mock Images",children:s.jsxDEV("div",{className:"form-container",children:s.jsxDEV("div",{className:"form-wrap",children:s.jsxDEV(f,{layout:"vertical",form:c,className:"form-box",children:I("mockedImages","Mocked Image",M,b,C,!0)},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:114,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:113,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:112,columnNumber:9},void 0)}],A=e=>{console.log(e)};n.useEffect(()=>{fetch(`https://bo-api.lorenzaceramica.com/product-details/${m}`).then(e=>e.json()).then(e=>{let i=[],r=[];e.images.length!==0&&e.images.map((t,u)=>i.push({uid:`-${u+1}`,name:`image_${u+1}_${Date.now()}`,status:"done",url:t})),e.mockedImages.length!==0&&e.mockedImages.map((t,u)=>r.push({uid:`-${u+1}`,name:`image_${u+1}_${Date.now()}`,status:"done",url:t})),c.setFieldsValue({images:i,mockedImages:r}),p(e)})},[]),n.useEffect(()=>{fetch("https://bo-api.lorenzaceramica.com/all-categories-no-level").then(e=>e.json()).then(e=>{let i=[];e.map(r=>{i.push({val:r.id,label:r.name})}),S(i)})},[]),n.useEffect(()=>{fetch("https://bo-api.lorenzaceramica.com/all-tags-no-level").then(e=>e.json()).then(e=>{let i=[];e.map(r=>{i.push({val:r.id,label:r.name})}),x(i)})},[]),n.useEffect(()=>{fetch("https://bo-api.lorenzaceramica.com/all-sizes").then(e=>e.json()).then(e=>{let i=[];e.map(r=>{i.push({val:r.id,label:r.name,id:r.id})}),U(i)})},[]),n.useEffect(()=>{fetch("https://bo-api.lorenzaceramica.com/all-finishes").then(e=>e.json()).then(e=>{let i=[];e.map(r=>{i.push({val:r.id,label:r.name,id:r.id})}),F(i)})},[]);const q=async e=>{for(const i of e){const r=new FormData;r.append("image",i.originFileObj),fetch(`https://bo-api.lorenzaceramica.com/upload-products-images/${m}`,{method:"POST",body:r}).then(async t=>{t.status===201&&(P("Upload Product Images Successful!"),l("/product-listing"))}).catch(t=>{console.log("Upload Product Images error:",t),d("Upload Product Images Failed. Please try again later.")})}},_=async e=>{for(const i of e){const r=new FormData;r.append("image",i.originFileObj),fetch(`https://bo-api.lorenzaceramica.com/upload-mocked-images/${m}`,{method:"POST",body:r}).then(async t=>{t.status===201&&(P("Upload Mocked Images Successful!"),l("/product-listing"))}).catch(t=>{console.log("Upload Mocked Images error:",t),d("Upload Mocked Images Failed. Please try again later.")})}},B=()=>{const e=c.getFieldsValue();if(e.images===void 0||e.images&&e.images.length===0)return d("Please ensure that image is uploaded.");if(e.mockedImages===void 0||e.mockedImages&&e.mockedImages.length===0)return d("Please ensure that Mocked Image is uploaded.");if(e.mockedImages.length>3)return d("Mocked Images only allow to upload 3(three) images.");let i=[],r=[],t=[];for(const a of e.images)a.status==="done"?i.push(a.url):r.push(a);for(const a of e.mockedImages)a.status==="done"?i.push(a.url):t.push(a);const u={name:e.prdName,code:e.prdCode,description:e.prdDesc,variation:e.prdVariation,thickness:e.prdThickness,color:e.prdColor,tags:e.prdTag,categories:e.prdCategory,size:e.prdSize,finish:e.prdFinish,sequence:e.sequence,notDeletedImageUrls:i};fetch("https://bo-api.lorenzaceramica.com/update-product",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...u,id:m})}).then(async a=>{a.status===204&&(P("Update Successful!"),r.length!==0&&q(r),t.length!==0&&_(t),r.length===0&&t.length===0&&l("/product-listing"))}).catch(a=>{console.log("Update Product error:",a),d("Update Failed. Please try again later.")})};return s.jsxDEV(s.Fragment,{children:[s.jsxDEV("div",{style:{textAlign:"left"},children:[s.jsxDEV("h2",{children:o},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:360,columnNumber:9},void 0),s.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:361,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:359,columnNumber:7},void 0),s.jsxDEV(X,{style:{textAlign:"left"},items:O,defaultActiveKey:["1","2","3"],onChange:A},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:363,columnNumber:7},void 0),";",s.jsxDEV("div",{className:"form-action-button-container",children:[s.jsxDEV(v,{type:"primary",className:"form-button",onClick:B,children:"Save"},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:372,columnNumber:9},void 0),s.jsxDEV(v,{className:"form-button",onClick:()=>l("/product-listing"),children:"Cancel"},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:375,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:371,columnNumber:7},void 0),s.jsxDEV(K,{displayImg:w,setDisplayImg:N},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:382,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:358,columnNumber:5},void 0)};export{ce as default};
