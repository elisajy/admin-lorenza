import{a as n,q as t,F as P,l as J,s as K,n as H,B as I}from"./index-BkWEOLim.js";import{P as Q,h as W}from"./PreviewImage-CAG5gjof.js";import{g as f,a as D,b as X,c as N,d as Y,e as k,U as y}from"./FormItems-Dw6BNSkf.js";import{C as Z}from"./Collapse-gknION_I.js";import"./index-CN0E7QP3.js";import"./Skeleton-pJUdaWfE.js";import"./useForceUpdate-BLQBKbLH.js";const ee=({form:u,data:o,categoryData:m,tagsData:c,sizesData:g,finishesData:p,colorsData:h})=>(n.useEffect(()=>{u.setFieldsValue({prdName:o==null?void 0:o.name,prdCode:o==null?void 0:o.code,prdDesc:o==null?void 0:o.description,prdFinish:o==null?void 0:o.finish,prdThickness:o==null?void 0:o.thickness,prdSize:o==null?void 0:o.size,prdColor:o==null?void 0:o.color,prdColorId:o==null?void 0:o.colorId,prdVariation:o==null?void 0:o.variation,prdTag:o==null?void 0:o.tags,prdCategory:o==null?void 0:o.categories,sequence:o==null?void 0:o.sequence})},[o]),t.jsxDEV(t.Fragment,{children:t.jsxDEV("div",{className:"form-container",children:[t.jsxDEV("div",{className:"form-wrap",children:t.jsxDEV(P,{layout:"vertical",form:u,className:"form-box",children:[f("Product Name","prdName","Please fill in the Product Name.","",!0),m&&m.length>0&&D("Product Category","prdCategory","Please select category.",!1,m),f("Product Variation","prdVariation","Please fill in the Product Variation."),X("Product Description","prdDesc","Please fill in the Product Description.",9)]},void 0,!0,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:38,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:37,columnNumber:17},void 0),t.jsxDEV("div",{className:"form-wrap",children:t.jsxDEV(P,{layout:"vertical",form:u,className:"form-box",children:[f("Product Code","prdCode","Please fill in the Product Code.","",!0),f("Product Thickness","prdThickness","Please fill in the Product Thickness."),g&&g.length>0&&N("Product Size","prdSize","Please select a Product Size.",!1,g),p&&p.length>0&&N("Product Finishes","prdFinish","Please select a Product Finishes.",!1,p),h&&h.length>0&&N("Color Category","prdColorId","Please select a Product Color Category.",!0,h),f("Product Color","prdColor","Please fill in the Product Color.","",!0),c&&c.length>0&&D("Product Tags","prdTag","Please select Tag.",!1,c),Y("Sequence","sequence","Please fill in sequence.")]},void 0,!0,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:54,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:53,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:36,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/ProductInfo-edit.tsx",lineNumber:35,columnNumber:9},void 0)),me=()=>{const u=J(),o="Edit Product",{id:m}=K(),[c]=P.useForm(),[g,p]=n.useState(),[h,S]=n.useState(),[x,j]=n.useState(),[U,V]=n.useState(),[F,L]=n.useState(),[T,w]=n.useState(),{setSuccessNotification:C,setErrorNotification:d}=H(),[oe,$]=n.useState(),[re,M]=n.useState(),[O,b]=n.useState({previewVisible:!1,previewImage:"",previewTitle:""}),v=e=>e.type==="image/jpeg"||e.type==="image/png"?e.size>1e6?(d("Image file size is more than 1MB. Please try a smaller size file."),y.LIST_IGNORE):!1:(d("Only .jpg, .jpeg and .png image file format are accepted!"),y.LIST_IGNORE),q=e=>Array.isArray(e)?e:($(e.file),e&&e.fileList),A=e=>Array.isArray(e)?e:(M(e.file),e&&e.fileList),E=async e=>{e=await W(e),b({previewVisible:!0,previewImage:e.url||e.preview,previewTitle:e.name||e.url.substring(e.url.lastIndexOf("/")+1)})},_=[{key:"1",label:"Basic Information",children:t.jsxDEV(ee,{form:c,data:g,categoryData:h,tagsData:x,sizesData:U,finishesData:F,colorsData:T},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:79,columnNumber:9},void 0)},{key:"2",label:"Product Images",children:t.jsxDEV("div",{className:"form-container",children:t.jsxDEV("div",{className:"form-wrap",children:t.jsxDEV(P,{layout:"vertical",form:c,className:"form-box",children:k("images","Product Image",q,E,v,!0)},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:96,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:95,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:94,columnNumber:9},void 0)},{key:"3",label:"Mock Images",children:t.jsxDEV("div",{className:"form-container",children:t.jsxDEV("div",{className:"form-wrap",children:t.jsxDEV(P,{layout:"vertical",form:c,className:"form-box",children:k("mockedImages","Mocked Image",A,E,v,!0)},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:116,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:115,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:114,columnNumber:9},void 0)}],B=e=>{console.log(e)};n.useEffect(()=>{fetch(`https://bo-api.lorenzaceramica.com/product-details/${m}`).then(e=>e.json()).then(e=>{let s=[],r=[];e.images.length!==0&&e.images.map((i,l)=>s.push({uid:`-${l+1}`,name:`image_${l+1}_${Date.now()}`,status:"done",url:i})),e.mockedImages.length!==0&&e.mockedImages.map((i,l)=>r.push({uid:`-${l+1}`,name:`image_${l+1}_${Date.now()}`,status:"done",url:i})),c.setFieldsValue({images:s,mockedImages:r}),p(e)})},[]),n.useEffect(()=>{fetch("https://bo-api.lorenzaceramica.com/all-categories-no-level").then(e=>e.json()).then(e=>{let s=[];e.map(r=>{s.push({val:r.id,label:r.name})}),S(s)})},[]),n.useEffect(()=>{fetch("https://bo-api.lorenzaceramica.com/all-tags-no-level").then(e=>e.json()).then(e=>{let s=[];e.map(r=>{s.push({val:r.id,label:r.name})}),j(s)})},[]),n.useEffect(()=>{fetch("https://bo-api.lorenzaceramica.com/all-sizes").then(e=>e.json()).then(e=>{let s=[];e.map(r=>{s.push({val:r.id,label:r.name,id:r.id})}),V(s)})},[]),n.useEffect(()=>{fetch("https://bo-api.lorenzaceramica.com/all-finishes").then(e=>e.json()).then(e=>{let s=[];e.map(r=>{s.push({val:r.id,label:r.name,id:r.id})}),L(s)})},[]),n.useEffect(()=>{fetch("https://bo-api.lorenzaceramica.com/all-colors").then(e=>e.json()).then(e=>{let s=[];e.map(r=>{s.push({val:r.id,label:r.name,id:r.id})}),w(s)})},[]);const R=async(e,s)=>{const r=new FormData;for(let i=0;i<e.length;i++){const l=e[i];r.append(`image-${i}`,l.originFileObj)}fetch(`https://bo-api.lorenzaceramica.com/upload-products-images/${m}`,{method:"POST",body:r}).then(async i=>{console.log("response",i.status),console.log("mockedArr",s),i.status===201&&(s.length!==0&&await z(s),C("Upload Product Images Successful!"))}).catch(i=>{console.log("Upload Product Images error:",i),d("Upload Product Images Failed. Please try again later.")})},z=async e=>{const s=new FormData;for(let r=0;r<e.length;r++){const i=e[r];s.append(`image-${r}`,i.originFileObj)}fetch(`https://bo-api.lorenzaceramica.com/upload-mocked-images/${m}`,{method:"POST",body:s}).then(async r=>{r.status===201&&C("Upload Mocked Images Successful!")}).catch(r=>{console.log("Upload Mocked Images error:",r),d("Upload Mocked Images Failed. Please try again later.")})},G=()=>{const e=c.getFieldsValue();if(e.images===void 0||e.images&&e.images.length===0)return d("Please ensure that image is uploaded.");if(e.mockedImages&&e.mockedImages.length>3)return d("Mocked Images only allow to upload 3(three) images.");let s=[],r=[],i=[];for(const a of e.images)a.status==="done"?s.push(a.url):r.push(a);for(const a of e.mockedImages)a.status==="done"?s.push(a.url):i.push(a);const l={name:e.prdName,code:e.prdCode,description:e.prdDesc,variation:e.prdVariation,thickness:e.prdThickness,color:e.prdColor,tags:e.prdTag,categories:e.prdCategory,size:e.prdSize,finish:e.prdFinish,sequence:e.sequence,colorId:e.prdColorId,notDeletedImageUrls:s};fetch("https://bo-api.lorenzaceramica.com/update-product",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...l,id:m})}).then(async a=>{a.status===204&&(C("Update Successful!"),r.length!==0?await R(r,i):r.length===0&&i.length!==0&&await z(i),u("/product-listing"))}).catch(a=>{console.log("Update Product error:",a),d("Update Failed. Please try again later.")})};return t.jsxDEV(t.Fragment,{children:[t.jsxDEV("div",{style:{textAlign:"left"},children:[t.jsxDEV("h2",{children:o},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:371,columnNumber:9},void 0),t.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:372,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:370,columnNumber:7},void 0),t.jsxDEV(Z,{style:{textAlign:"left"},items:_,defaultActiveKey:["1","2","3"],onChange:B},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:374,columnNumber:7},void 0),";",t.jsxDEV("div",{className:"form-action-button-container",children:[t.jsxDEV(I,{type:"primary",className:"form-button",onClick:G,children:"Save"},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:383,columnNumber:9},void 0),t.jsxDEV(I,{className:"form-button",onClick:()=>u(-1),children:"Cancel"},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:386,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:382,columnNumber:7},void 0),t.jsxDEV(Q,{displayImg:O,setDisplayImg:b},void 0,!1,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:393,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/Phing/Documents/SookCheng/LorenzaCeramica/admin-lorenza/src/pages/products/EditProduct/EditProduct.tsx",lineNumber:369,columnNumber:5},void 0)};export{me as default};
